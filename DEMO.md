# HippoRAG 演示指南

本文档展示如何对比传统 RAG 和 HippoRAG 的检索效果。

## 测试场景

**问题**: 爱因斯坦出生于哪个世纪？

**测试文档**:
1. "阿尔伯特·爱因斯坦是著名的物理学家"
2. "爱因斯坦于1879年3月14日出生于德国乌尔姆"
3. "他在1905年发表了相对论"
4. "19世纪是指1801年到1900年这段时期"
5. "爱因斯坦在1921年获得诺贝尔物理学奖"

**关键点**: 
- 回答这个问题需要结合**文档2**（出生年份1879）和**文档4**（19世纪定义）
- 传统 RAG 可能只检索到与"爱因斯坦"相关的文档，而忽略"19世纪"的定义
- HippoRAG 通过知识图谱可以发现"1879"和"19世纪"之间的关联

## 环境准备

1. 确保已配置 OpenAI API Key：
```bash
cp .env.example .env
# 编辑 .env 文件，填入你的 API Key
```

2. 下载依赖：
```bash
make deps
```

## 四个演示命令

### 命令1: 传统 RAG 检索 + LLM 生成答案

**运行**:
```bash
make demo1
```

**展示内容**:
- ✅ 索引过程
- ✅ 向量相似度检索过程
- ✅ 检索到的文档（Top-3）
- ✅ LLM 生成的答案

**预期结果**:
- 可能检索到文档1、2、3（都包含"爱因斯坦"）
- 可能**遗漏文档4**（19世纪定义）
- LLM 可能无法准确回答"哪个世纪"

---

### 命令2: 传统 RAG 仅检索（不生成答案）

**运行**:
```bash
make demo2
```

**展示内容**:
- ✅ 索引过程
- ✅ 向量相似度检索过程
- ✅ 检索到的文档及相似度分数
- ❌ 不生成答案（仅展示检索）

**用途**: 
- 观察传统 RAG 的检索逻辑
- 分析哪些文档被检索到，哪些被遗漏

---

### 命令3: HippoRAG 检索 + LLM 生成答案

**运行**:
```bash
make demo3
```

**展示内容**:
- ✅ 索引过程（文档分块、实体提取、图构建）
- ✅ 索引统计（文档块、实体、事实、图节点/边）
- ✅ 实体检索过程
- ✅ PPR 图传播过程
- ✅ 检索到的文档块及 PPR 分数
- ✅ LLM 生成的答案

**预期结果**:
- 通过实体"爱因斯坦"和"1879"找到相关节点
- PPR 算法在图上传播，发现"19世纪"的关联
- 检索到文档2和文档4
- LLM 能够准确回答"19世纪"

---

### 命令4: HippoRAG 仅检索（不生成答案）

**运行**:
```bash
make demo4
```

**展示内容**:
- ✅ 索引过程
- ✅ 实体检索 → PPR 传播 → 文档排序
- ✅ 详细的检索步骤和中间结果
- ❌ 不生成答案（仅展示检索）

**用途**:
- 深入理解 HippoRAG 的检索机制
- 观察 PPR 如何在知识图谱上传播
- 分析为什么能检索到关联文档

---

## 对比分析

### 传统 RAG vs HippoRAG

| 特性 | 传统 RAG | HippoRAG |
|------|---------|----------|
| **检索方法** | 向量相似度 | 实体检索 + PPR 图传播 |
| **能否发现关联** | ❌ 只能找到直接相关的文档 | ✅ 能发现间接关联 |
| **知识图谱** | ❌ 无 | ✅ 有（实体+关系） |
| **多跳推理** | ❌ 不支持 | ✅ 支持 |
| **适用场景** | 简单问答 | 复杂推理问答 |

### 预期检索结果对比

**传统 RAG** (命令1/2):
```
检索结果:
1. [相似度: 0.85] 阿尔伯特·爱因斯坦是著名的物理学家
2. [相似度: 0.82] 爱因斯坦于1879年3月14日出生于德国乌尔姆
3. [相似度: 0.78] 爱因斯坦在1921年获得诺贝尔物理学奖

❌ 遗漏: "19世纪是指1801年到1900年这段时期"
```

**HippoRAG** (命令3/4):
```
检索结果:
1. [PPR分数: 0.156] 爱因斯坦于1879年3月14日出生于德国乌尔姆
2. [PPR分数: 0.089] 19世纪是指1801年到1900年这段时期
3. [PPR分数: 0.067] 阿尔伯特·爱因斯坦是著名的物理学家

✅ 成功检索到关键文档2和4
```

## 交互式使用

所有命令都支持交互式输入：

```bash
make demo1

# 进入交互模式后
❓ 请输入问题: 爱因斯坦出生于哪个世纪？
# ... 显示检索和生成过程 ...

❓ 请输入问题: 爱因斯坦获得诺贝尔奖是哪一年？
# ... 继续提问 ...

❓ 请输入问题: quit
👋 再见！
```

## 编译可执行文件

如果想编译成独立的可执行文件：

```bash
make build-all

# 运行编译后的程序
./bin/demo1
./bin/demo2
./bin/demo3
./bin/demo4
```

## 清理

```bash
make clean
```

## 常见问题

### Q: 为什么 HippoRAG 索引时间更长？

A: HippoRAG 需要：
- 使用 LLM 提取实体和关系
- 构建知识图谱
- 生成多个向量（文档块、实体、事实）

但这带来了更好的检索效果。

### Q: 如何调整检索参数？

A: 编辑对应的 `main.go` 文件，修改配置：

```go
config := hipporag.DefaultConfig()
config.TopKEntities = 10  // 检索更多实体
config.TopKChunks = 5     // 返回更多文档块
config.PPRDamping = 0.7   // 调整 PPR 阻尼系数
```

### Q: 如何添加更多测试文档？

A: 编辑 `data/documents.go` 文件：

```go
var TestDocuments = []string{
    "你的文档1",
    "你的文档2",
    // ...
}
```

## 下一步

- 尝试不同的问题
- 添加更多测试文档
- 调整检索参数观察效果变化
- 对比两种方法的检索质量
